{{define "title"}}Roster{{end}}
{{define "head"}}
	{{JS "/static/js/vue.min.js"}}
	{{JS "/static/js/vue-resource.min.js"}}
{{end}}
{{define "content"}}

<div id="roster">

	<div class="page-header">
		<span v-for="(group, gid) in groups">
			[<a :href="'#' + gid">${group}</a>]
		</span>
	</div>

	<div v-for="(group, gid) in groups" class="panel panel-default">
		<div :id="gid" class="panel-heading">
			<h2 class="panel-title">
				<span>${group}</span>
				<group-title :gid="gid"></group-title>
			</h2>
		</div>

		<div class="panel-body">
			<group-head :gid="gid"></group-head>
		</div>

		<!-- foot: details -->

	</div>

</div>

<template id="group-head">
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-2">links</div>
			<div class="col-md-5">
				<div v-for="(role, id) in grouphead" v-if="id == 'Steward' || id == 'Product Manager'">
					<strong>${id}<span v-if="role.length > 1">s</span>:</strong>
					<a v-for="man in role" :href="'https://rover.redhat.com/people/profile/' + man.ID + '/'"> ${man.Name}</a>
				</div>
			</div>
			<div class="col-md-5">
				<div v-for="(role, id) in grouphead" v-if="id == 'User Advocate' || id == 'Team Catalyst' || id == 'Squad Lead'">
					<strong>${id}<span v-if="role.length > 1">s</span>:</strong>
					<a v-for="man in role" :href="'https://rover.redhat.com/people/profile/' + man.ID + '/'"> ${man.Name}</a>
				</div>
			</div>
		</div>
	</div>
</template>

<template id="group-title">
	<span class="pull-right">
		<span v-if="groupsize.squads" title="Squads"><i class="fa fa-users"></i> ${groupsize.squads}</span>
		<span title="People"><i class="fa fa-user-circle-o"></i> ${groupsize.people}</span>
	</span>
</template>

<script type="text/javascript">
	var GroupHead = {
		template: '#group-head',
		delimiters: ['${', '}'],
		props: ['gid'],
		data: function() {
			return {
				grouphead: [],
			};
		},
		mounted: function() {
			this.$http.get('roster/v2/groups/' + this.gid + '/head').then(function(response) {
				this.grouphead = response.body
			});
		},
	};

	var GroupTitle = {
		template: '#group-title',
		delimiters: ['${', '}'],
		props: ['gid'],
		data: function() {
			return {
				groupsize: [],
			};
		},
		mounted: function() {
			this.$http.get('roster/v2/groups/' + this.gid + '/size').then(function(response) {
				this.groupsize = response.body;
			});
		},
	};

	let roster = new Vue({
		el: '#roster',
		delimiters: ['${', '}'],
		data: {
			groups: [],
		},
		mounted: function() {
			this.$http.get('/roster/v2/groups').then(function(response) {
				this.groups = response.body;
			});
		},
		components: {
			'group-title': GroupTitle,
			'group-head': GroupHead,
		},
	});
</script>

{{JS "/static/js/jquery.dataTables.min.js"}}
{{template "footer" .}}{{end}}
{{define "foot"}}{{end}}